<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2011 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>

<div class="footer-container row">
<?php if(Mage::registry('current_category') ):?>
<?php
    $categories = Mage::getModel('catalog/category')->load(Mage::registry('current_category')->getID())->getChildren();
    $categoryIDs = explode(',',$categories);
?>
<nav role="navigation" id="bottomMenu" style="" class="show-for-small columns twelve">
        <ul class="nav-bar" id="bottomNav">
            <?php foreach($categoryIDs as $categoryID): ?>
            <li>
                <?php $category = Mage::getModel('catalog/category')->load($categoryID);?>
                <a href="<?php echo $category->getUrl()?>">
                    <?php echo $category->getName()?>
                </a>
            </li>
            <?php endforeach; ?>
        </ul>
</nav>
<?php else: ?>
    <nav role="navigation" id="bottomMenu" style="" class="show-for-small columns twelve">
        <?php $_helper = Mage::helper('catalog/category') ?>
        <?php $_categories = $_helper->getStoreCategories() ?>
        <?php if (count($_categories) > 0): ?>
        <ul class="nav-bar" id="bottomNav">
            <?php foreach($_categories as $_category): ?>
            <li>
                <a href="<?php echo $_helper->getCategoryUrl($_category) ?>">
                    <?php echo $_category->getName() ?>
                </a>
            </li>
            <?php endforeach; ?>
        </ul>
        <?php endif; ?>
    </nav>
    <?php endif; ?>

    <div class="footer columns twelve">
        <?php echo $this->getChildHtml() ?>
    </div>
    <hr />
    <address class="row"><?php echo $this->getCopyright() ?></address>

</div>
<script type="text/javascript" >

    ;(function (window, document, $) {
        // Set the negative margin on the top menu for slide-menu pages
        var $selector1 = $('#topMenu'),
                events = 'click.fndtn';
        if ($selector1.length > 0) $selector1.css("margin-top", $selector1.height() * -1);

        // Watch for clicks to show the sidebar
        var $selector2 = $('#sidebarButton');
        if ($selector2.length > 0) {
            $('#sidebarButton').on(events, function (e) {
                e.preventDefault();
                $('body').toggleClass('active');
            });
        }

        // Watch for clicks to show the menu for slide-menu pages
        var $selector3 = $('#menuButton');
        if ($selector3.length > 0) {
            $('#menuButton').on(events, function (e) {
                //e.preventDefault();
                $('body').toggleClass('active-menu');
            });
        }

        // // Adjust sidebars and sizes when resized
        // $(window).resize(function() {
        // // if (!navigator.userAgent.match(/Android/i)) $('body').removeClass('active');
        // var $selector4 = $('#topMenu');
        // if ($selector4.length > 0) $selector4.css("margin-top", $selector4.height() * -1);
        // });

        // Switch panels for the paneled nav on mobile
        var $selector5 = $('#switchPanels');
        if ($selector5.length > 0) {
            $('#switchPanels dd').on(events, function (e) {
                e.preventDefault();
                var switchToPanel = $(this).children('a').attr('href'),
                        switchToIndex = $(switchToPanel).index();
                $(this).toggleClass('active').siblings().removeClass('active');
                $(switchToPanel).parent().css("left", (switchToIndex * (-100) + '%'));
            });
        }

        $('#nav-zurb li a').on(events, function (e) {
            e.preventDefault();
            var href = $(this).attr('href'),
                    $target = $(href);
            $('html, body').animate({scrollTop : $target.offset().top}, 300);
        });
    }(this, document, jQuery));

</script>